# Сервис для поиска по документам (постам)

## Технические детали
Технологии `Python/asyncio`, `FastAPI`, `Elasticsearch`, `Redis`, `Docker/docker-compose`.

Все вызовы являются асинхронными.


### Описание эндпоинтов

`POST /search` - принимает на вход определённый текстовый запрос `{"text":"some data"}`, осуществляет поиск и выводит 20 значений, отсортированных по дате. Происходит кеширование с помощью асинхронного клиента redis.asyncio, при повторных запросах отдаёт данные из кеша.

`GET /post/{post_id}` -  принимает на вход в качестве параметра пути идентификатор поста и отдаёт информацию о посте в единственном экземпляре. Также кеширует и при повторном запросе отдаёт из кеша.

`DELETE /post/{post_id}` - принимает на вход в качестве параметра пути идентификатор поста, возвращает статус `200` если удаление произошло успешно, статус `404` если пост найти не удалось.

### Развертывание.

1. Клонировать репозиторий.

```
~$ git clone https://github.com/neekrasov/doc-search.git
```

2. Создать файл dev.env на примере example.env
```
~$ cp example.env dev.env
```

3. Поднять контейнеры.
```
~$ docker compose up
```
4. Открыть в браузере http://localhost:8000/api/docs .

### Дополнительно.

Документация в json формате представлена по адресу http://localhost:8000/api/openapi.json .

Исходники по базе данных в формате `csv` представлены в каталоге `sources`.

Сервис реплицируется на 4 процесса. `gunicorn` используется в качестве диспетчера процессов, `uvicorn` в качестве рабочего процесса на каждом из воркеров.

